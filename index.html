<!DOCTYPE html>
<html>
<head>
  <title>PantelMed Test App</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      background-color: #ffffff;
      color: #111;
      padding: 20px;
    }
    .container {
      max-width: 400px;
      margin: auto;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
    }
    .paid-content {
      margin-top: 30px;
      background: #e8f5e9;
      padding: 15px;
      border-radius: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>PantelMed: –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø</h2>
    <p>–û–ø–ª–∞—Ç–∏ –Ω–∏–∂—á–µ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å—Ç–µ–∫–∞ –¥–æ–±–∞–≤–æ–∫, —Å–ø–∏—Å–∫—É –∞–Ω–∞–ª—ñ–∑—ñ–≤ —Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞</p>

    <a href="pay.html" target="_blank">
      <button>üí≥ –û–ø–ª–∞—Ç–∏—Ç–∏ –∫–∞—Ä—Ç–∫–æ—é —á–µ—Ä–µ–∑ Onramper</button>
    </a>

    <button id="payBtn">–Ø –æ–ø–ª–∞—Ç–∏–≤</button>

    <div class="paid-content" id="paidContent">
      <h3>‚úÖ –î–æ—Å—Ç—É–ø –≤—ñ–¥–∫—Ä–∏—Ç–æ!</h3>
      <ul>
        <li><b>–î–æ–±–∞–≤–∫–∏:</b> —Ü–∏–Ω–∫, –º–∞–≥–Ω—ñ–π, –æ–º–µ–≥–∞-3</li>
        <li><b>–ê–Ω–∞–ª—ñ–∑–∏:</b> –¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω, –í—ñ—Ç–∞–º—ñ–Ω D, TSH</li>
        <li><b>–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä:</b> –±—É–¥–µ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó</li>
      </ul>
    </div>
  </div>

  <script>
    const telegram = window.Telegram?.WebApp || {};
    telegram.ready?.();

    const userId = telegram.initDataUnsafe?.user?.id;
    console.log("Telegram user ID:", userId);
    alert("–í–∞—à Telegram ID: " + userId);

    const payBtn = document.getElementById("payBtn");

    if (!userId) {
      payBtn.disabled = true;
      payBtn.innerText = "ID –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –∑ Telegram";
    } else {
      payBtn.addEventListener("click", () => {
        fetch("https://pantelmed.onrender.com/check_payment", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ user_id: userId })
        })
          .then(res => res.json())
          .then(data => {
            console.log("Backend response:", data);
            if (data.paid) {
              document.getElementById("paidContent").style.display = "block";
              payBtn.innerText = "‚úÖ –û–ø–ª–∞—Ç–∞ –∑–Ω–∞–π–¥–µ–Ω–∞";
              payBtn.disabled = true;
            } else {
              alert("‚ùå –ü–ª–∞—Ç—ñ–∂ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —á–µ—Ä–µ–∑ —Ö–≤–∏–ª–∏–Ω—É –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä –∞–¥—Ä–µ—Å—É.");
            }
          })
          .catch(error => {
            console.error("Error during payment check:", error);
            alert("üö´ –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –ø—ñ–∑–Ω—ñ—à–µ.");
          });
      });
    }
  </script>
</body>
</html>
